<script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // Extract language from parent div and highlight with correct language
    // Skip special blocks like mermaid which are handled by other libraries
    const skipLanguages = ['mermaid', 'txt', 'text'];

    document.querySelectorAll('div[class*="language-"] pre code').forEach((block) => {
      // Skip if already highlighted
      if (block.getAttribute('data-highlighted') === 'yes') {
        return;
      }

      const divClass = block.parentElement.parentElement.parentElement.className;
      const languageMatch = divClass.match(/language-(\w+)/);

      if (languageMatch) {
        const language = languageMatch[1];

        // Skip certain languages
        if (skipLanguages.includes(language)) {
          return;
        }

        // Set language and highlight
        block.classList.remove('hljs');
        block.classList.add('hljs', 'language-' + language);

        try {
          hljs.highlightElement(block);
        } catch (e) {
          console.warn('Failed to highlight language:', language, e);
        }
      }
    });
  });
</script>
